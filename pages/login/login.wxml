<!-- 登录页面 - 使用微信2022新版头像昵称填写能力 -->
<view class="login-page">
  <!-- 顶部装饰背景 -->
  <view class="header-bg">
    <view class="header-curve"></view>
  </view>

  <!-- Logo 区域 -->
  <view class="logo-area">
    <view class="logo-circle">
      <image class="logo-img" src="cloud://cloud1-5gh4dyhpb180b5fb.636c-cloud1-5gh4dyhpb180b5fb-1406006729/images/logo.png" mode="aspectFit" />
    </view>
    <text class="brand-name">小赵面食</text>
    <text class="brand-slogan">用心烘焙每一份温暖</text>
  </view>

  <!-- 登录卡片 - 新版轻量登录 -->
  <view class="login-card">
    <view class="card-header">
      <text class="welcome-title">欢迎回来</text>
      <text class="welcome-subtitle">完善信息，享受会员权益</text>
    </view>

    <!-- 新版头像昵称填写区域 -->
    <view class="profile-form">
      <!-- 头像选择 - 使用新版 chooseAvatar -->
      <button
        class="avatar-wrapper"
        open-type="chooseAvatar"
        bind:chooseavatar="onChooseAvatar"
      >
        <image class="avatar-img" src="{{userInfo.avatarUrl || '/assets/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="avatar-badge">
          <text class="avatar-badge-icon">📷</text>
        </view>
        <text class="avatar-tip">{{userInfo.avatarUrl ? '点击更换头像' : '点击选择头像'}}</text>
      </button>

      <!-- 昵称输入 - 使用新版 nickname input -->
      <view class="nickname-wrapper">
        <text class="input-label">昵称</text>
        <input
          type="nickname"
          class="nickname-input"
          placeholder="请输入或选择微信昵称"
          value="{{userInfo.nickName}}"
          bind:change="onNickNameChange"
          bind:nicknamereview="onNickNameReview"
        />
        <text class="input-hint">支持自动获取微信昵称</text>
      </view>
    </view>

    <!-- 登录按钮组 -->
    <view class="login-actions">
      <!-- 手机号一键登录（推荐）-->
      <button
        class="btn btn-primary btn-phone"
        open-type="getPhoneNumber"
        bind:getphonenumber="onPhoneLogin"
        loading="{{isLoading}}"
        disabled="{{isLoading}}"
      >
        <text class="btn-icon">📱</text>
        <text class="btn-text">微信一键登录</text>
      </button>

      <!-- 传统登录方式（备用）-->
      <button
        class="btn btn-link"
        bindtap="onWechatLogin"
        loading="{{isLoading}}"
        disabled="{{isLoading}}"
        wx:if="{{canUseOldLogin}}"
      >
        <text class="btn-text">使用传统方式登录</text>
      </button>
    </view>

    <!-- 用户协议 -->
    <view class="agreement-box">
      <view class="checkbox-wrap" bindtap="onAgreementToggle">
        <view class="checkbox {{agreed ? 'checked' : ''}}">
          <image wx:if="{{agreed}}" class="check-icon" src="{{icons.check}}" mode="aspectFit" />
        </view>
      </view>
      <text class="agreement-text">
        我已阅读并同意
        <text class="link" catchtap="onUserAgreementTap">《用户协议》</text>
        和
        <text class="link" catchtap="onPrivacyPolicyTap">《隐私政策》</text>
      </text>
    </view>
  </view>

  <!-- 会员权益 -->
  <view class="benefits-area">
    <view class="section-title">
      <view class="title-line"></view>
      <text class="title-text">会员权益</text>
      <view class="title-line"></view>
    </view>

    <view class="benefits-grid">
      <view class="benefit-item">
        <view class="benefit-icon" style="background: #FFF0F0;">
          <text>🎂</text>
        </view>
        <text class="benefit-name">生日特权</text>
      </view>
      <view class="benefit-item">
        <view class="benefit-icon" style="background: #FFF8EE;">
          <text>💰</text>
        </view>
        <text class="benefit-name">积分抵现</text>
      </view>
      <view class="benefit-item">
        <view class="benefit-icon" style="background: #E8F8F7;">
          <text>🎁</text>
        </view>
        <text class="benefit-name">专属优惠</text>
      </view>
      <view class="benefit-item">
        <view class="benefit-icon" style="background: #F0F9EB;">
          <text>🚀</text>
        </view>
        <text class="benefit-name">优先配送</text>
      </view>
    </view>
  </view>

  <!-- 底部返回 -->
  <view class="footer-action">
    <text class="back-link" bindtap="onBackTap">暂不登录，先逛逛</text>
  </view>
</view>

<!-- Toast 提示 -->
<toast id="toast"></toast>
