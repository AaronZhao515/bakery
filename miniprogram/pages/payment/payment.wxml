<!-- æ”¯ä»˜é¡µé¢ -->
<view class="payment-container">
  <!-- æ”¯ä»˜é‡‘é¢ -->
  <view class="pay-amount-section">
    <text class="pay-label">æ”¯ä»˜é‡‘é¢</text>
    <view class="pay-amount">
      <text class="currency">Â¥</text>
      <text class="amount">{{payAmount}}</text>
    </view>
    <text class="pay-desc">è®¢å•å·: {{orderNo}}</text>
  </view>

  <!-- ç§¯åˆ†ä¿¡æ¯ -->
  <view class="points-section" wx:if="{{requiredPoints > 0}}">
    <view class="points-info">
      <text class="points-label">éœ€è¦ç§¯åˆ†</text>
      <text class="points-value {{hasEnoughPoints ? '' : 'insufficient'}}">{{userPoints}} / {{requiredPoints}}</text>
    </view>
    <view class="points-hint" wx:if="{{!hasEnoughPoints}}">
      <text class="hint-text">âš ï¸ ç§¯åˆ†ä¸è¶³ï¼Œè¯·é€‰æ‹©çº¿ä¸‹æ”¯ä»˜</text>
    </view>
  </view>

  <!-- æ”¯ä»˜æ–¹å¼ -->
  <view class="pay-method-section">
    <text class="section-title">é€‰æ‹©æ”¯ä»˜æ–¹å¼</text>
    <view class="method-list">
      <!-- ç§¯åˆ†æ”¯ä»˜ -->
      <view class="method-item {{selectedMethod === 'points' ? 'active' : ''}} {{!hasEnoughPoints ? 'disabled' : ''}}" bindtap="selectMethod" data-method="points">
        <view class="method-icon">
          <text class="icon">â­</text>
        </view>
        <view class="method-info">
          <text class="method-name">ç§¯åˆ†æ”¯ä»˜</text>
          <text class="method-desc">{{hasEnoughPoints ? 'ä½¿ç”¨ ' + requiredPoints + ' ç§¯åˆ†æ”¯ä»˜' : 'ç§¯åˆ†ä¸è¶³ï¼ˆéœ€è¦ ' + requiredPoints + ' ç§¯åˆ†ï¼‰'}}</text>
        </view>
        <view class="check-icon" wx:if="{{selectedMethod === 'points'}}">âœ“</view>
        <view class="disabled-tag" wx:if="{{!hasEnoughPoints}}">ä¸å¯ç”¨</view>
      </view>

      <!-- çº¿ä¸‹æ”¯ä»˜ -->
      <view class="method-item {{selectedMethod === 'offline' ? 'active' : ''}}" bindtap="selectMethod" data-method="offline">
        <view class="method-icon">
          <text class="icon">ğŸª</text>
        </view>
        <view class="method-info">
          <text class="method-name">çº¿ä¸‹æ”¯ä»˜</text>
          <text class="method-desc">åˆ°åº—æ‰«ç æ”¯ä»˜ç°é‡‘</text>
        </view>
        <view class="check-icon" wx:if="{{selectedMethod === 'offline'}}">âœ“</view>
      </view>
    </view>
  </view>

  <!-- è®¢å•ä¿¡æ¯ -->
  <view class="order-info-section">
    <text class="section-title">è®¢å•ä¿¡æ¯</text>
    <view class="info-list">
      <view class="info-item">
        <text class="info-label">å•†å“æ€»é¢</text>
        <text class="info-value">Â¥{{goodsTotal}}</text>
      </view>
      <view class="info-item" wx:if="{{deliveryFee > 0}}">
        <text class="info-label">é…é€è´¹</text>
        <text class="info-value">Â¥{{deliveryFee}}</text>
      </view>
      <view class="info-item" wx:if="{{discountAmount > 0}}">
        <text class="info-label">ä¼˜æƒ é‡‘é¢</text>
        <text class="info-value discount">-Â¥{{discountAmount}}</text>
      </view>
    </view>
  </view>

  <!-- æ”¯ä»˜æŒ‰é’® -->
  <view class="pay-button-section">
    <button class="pay-btn {{paying ? 'paying' : ''}} {{!hasEnoughPoints ? 'offline-btn' : ''}}" bindtap="confirmPay" disabled="{{paying}}">
      <text wx:if="{{!paying && hasEnoughPoints}}">ç¡®è®¤æ”¯ä»˜ {{requiredPoints}} ç§¯åˆ†</text>
      <text wx:if="{{!paying && !hasEnoughPoints}}">ç¡®è®¤çº¿ä¸‹æ”¯ä»˜</text>
      <view class="loading" wx:if="{{paying}}">
        <view class="loading-spinner"></view>
        <text>å¤„ç†ä¸­...</text>
      </view>
    </button>
  </view>

  <!-- å®‰å…¨æç¤º -->
  <view class="security-tips" wx:if="{{hasEnoughPoints}}">
    <text class="tip-icon">ğŸ”’</text>
    <text class="tip-text">æ”¯ä»˜å®‰å…¨ç”±CloudBaseä¿éšœ</text>
  </view>
  <view class="security-tips" wx:if="{{!hasEnoughPoints}}">
    <text class="tip-icon">ğŸª</text>
    <text class="tip-text">è¯·åˆ°åº—å†…æ‰«ç æ”¯ä»˜ç°é‡‘</text>
  </view>
</view>
