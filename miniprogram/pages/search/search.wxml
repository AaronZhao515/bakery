<!-- æœç´¢é¡µ -->
<view class="search-container">
  <!-- æœç´¢æ  -->
  <view class="search-header" style="padding-top: {{statusBarHeight}}px;">
    <view class="search-bar">
      <view class="search-input-wrapper">
        <text class="search-icon">ğŸ”</text>
        <input class="search-input" type="text" placeholder="æœç´¢å•†å“åç§°" value="{{keyword}}" focus="{{true}}" confirm-type="search" bindinput="onInput" bindconfirm="onSearch" />
        <view wx:if="{{keyword}}" class="clear-btn" bindtap="onClearTap">
          <text>âœ•</text>
        </view>
      </view>
      <view class="search-cancel" bindtap="onCancelTap">å–æ¶ˆ</view>
    </view>
  </view>

  <!-- æœç´¢å»ºè®® -->
  <view class="search-suggestions" wx:if="{{showSuggestions && suggestions.length > 0}}">
    <view class="suggestion-item" wx:for="{{suggestions}}" wx:key="index" bindtap="onSuggestionTap" data-keyword="{{item}}">
      <text class="suggestion-icon">ğŸ”</text>
      <text class="suggestion-text">{{item}}</text>
    </view>
  </view>

  <!-- æœç´¢å†…å®¹åŒº -->
  <view class="search-content" wx:if="{{!showSuggestions}}">
    <!-- æœç´¢ç»“æœ -->
    <view class="search-results" wx:if="{{hasSearched}}">
      <!-- ç»“æœå¤´éƒ¨ -->
      <view class="results-header">
        <text class="results-count">å…± {{totalCount}} ä¸ªç»“æœ</text>
        <view class="results-filter">
          <view class="filter-item {{sortType === 'default' ? 'active' : ''}}" bindtap="onSortTap" data-type="default">ç»¼åˆ</view>
          <view class="filter-item {{sortType === 'sales' ? 'active' : ''}}" bindtap="onSortTap" data-type="sales">é”€é‡</view>
          <view class="filter-item {{sortType === 'price' ? 'active' : ''}}" bindtap="onSortTap" data-type="price">
            ä»·æ ¼
            <text class="sort-arrow">{{priceSort === 'asc' ? 'â†‘' : (priceSort === 'desc' ? 'â†“' : '')}}</text>
          </view>
        </view>
      </view>

      <!-- å•†å“åˆ—è¡¨ -->
      <view class="product-list" wx:if="{{products.length > 0}}">
        <view class="product-item" wx:for="{{products}}" wx:key="id" bindtap="onProductTap" data-id="{{item.id}}">
          <image class="product-image" src="{{item.image}}" mode="aspectFill" lazy-load="{{true}}" />
          <view class="product-info">
            <view class="product-name-wrapper">
              <text class="product-name">{{item.name}}</text>
            </view>
            <text class="product-desc">{{item.description}}</text>
            <view class="product-meta">
              <text class="product-sales">æœˆé”€ {{item.sales}}</text>
              <view class="product-rating" wx:if="{{item.rating}}">
                <text class="rating-star">â˜…</text>
                <text class="rating-score">{{item.rating}}</text>
              </view>
            </view>
            <view class="product-bottom">
              <view class="product-price">
                <text class="price price-medium">{{item.price}}</text>
                <text wx:if="{{item.originalPrice}}" class="original-price">{{item.originalPrice}}</text>
              </view>
              <view class="add-cart-btn" catchtap="onAddCart" data-item="{{item}}">
                <text>+</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{products.length === 0 && !loading}}">
        <text class="empty-icon">ğŸ”</text>
        <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³å•†å“</text>
        <text class="empty-subtext">æ¢ä¸ªå…³é”®è¯è¯•è¯•å§~</text>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view class="load-more" wx:if="{{loading}}">
        <view class="loading-spinner"></view>
        <text>åŠ è½½ä¸­...</text>
      </view>
      <view class="load-more" wx:if="{{!loading && !hasMore && products.length > 0}}">
        <text>å·²ç»åˆ°åº•å•¦~</text>
      </view>
    </view>

    <!-- æœç´¢å†å²å’Œçƒ­é—¨æœç´¢ -->
    <view class="search-tips" wx:if="{{!hasSearched}}">
      <!-- æœç´¢å†å² -->
      <view class="history-section" wx:if="{{searchHistory.length > 0}}">
        <view class="section-header">
          <text class="section-title">æœç´¢å†å²</text>
          <view class="clear-history" bindtap="onClearHistory">
            <text class="clear-icon">ğŸ—‘ï¸</text>
            <text>æ¸…ç©º</text>
          </view>
        </view>
        <view class="tag-list">
          <view class="tag-item" wx:for="{{searchHistory}}" wx:key="index" bindtap="onHistoryTap" data-keyword="{{item}}">
            <text>{{item}}</text>
          </view>
        </view>
      </view>

      <!-- çƒ­é—¨æœç´¢ -->
      <view class="hot-section">
        <view class="section-header">
          <text class="section-title">çƒ­é—¨æœç´¢</text>
        </view>
        <view class="tag-list">
          <view class="tag-item hot" wx:for="{{hotKeywords}}" wx:key="index" bindtap="onHotTap" data-keyword="{{item}}">
            <text class="hot-rank {{index < 3 ? 'top' : ''}}">{{index + 1}}</text>
            <text>{{item}}</text>
          </view>
        </view>
      </view>

      <!-- æ¨èåˆ†ç±» -->
      <view class="category-section">
        <view class="section-header">
          <text class="section-title">æ¨èåˆ†ç±»</text>
        </view>
        <view class="category-grid">
          <view class="category-item" wx:for="{{recommendCategories}}" wx:key="id" bindtap="onCategoryTap" data-id="{{item.id}}">
            <image class="category-image" src="{{item.image}}" mode="aspectFill" />
            <text class="category-name">{{item.name}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
